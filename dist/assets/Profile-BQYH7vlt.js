import{g as ae,r as a,j as e,k as Ce,w as Se,l as ke,n as re,x as Pe,z as ee,A as L,B as Fe,C as Ee,D as ze,a as _e,y as x,S as Oe,E as Ie}from"./index-D-ho5R0I.js";import{B as le}from"./Button-DQgPLd3p.js";/* empty css                      */import{c as Ae,I as te}from"./Category-DBMhr-0u.js";import{p as se,g as Le,b as Me,r as $e,a as Te}from"./metadata.max.json-CsV9usw-.js";const Ue=$e,Be="/api",Re=["1 – 50","51 – 100","100 – 500","500+"],We=["Sole Proprietorship","Partnership","Corporation","LLC","Nonprofit","Other"],De=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],S=Le().map(s=>({code:s,dialCode:`+${Te(s)}`,name:new Intl.DisplayNames(["en"],{type:"region"}).of(s)||s})).sort((s,n)=>s.name.localeCompare(n.name)),Ve=({open:s,onClose:n})=>{const{user:t,loadUser:c}=ae(),[i,m]=a.useState(t?.name||""),[r,u]=a.useState(t?.avatar||""),[d,$]=a.useState(null),[b,T]=a.useState("US"),[U,B]=a.useState(""),[ne,ie]=a.useState(!1),[g,R]=a.useState(t?.company_name||""),[k,W]=a.useState(t?.address1||""),[P,D]=a.useState(t?.address2||""),[j,V]=a.useState(t?.city||""),[F,Z]=a.useState(t?.us_state||""),[w,G]=a.useState(t?.post_code||""),[N,H]=a.useState(t?.website||""),[E,Y]=a.useState(t?.industry||""),[z,q]=a.useState(t?.employees||""),[_,J]=a.useState(t?.biz_type||""),[oe,ce]=a.useState(!1),[de,me]=a.useState(!1),[ue,pe]=a.useState(!1),[xe,he]=a.useState(!1),[O,fe]=a.useState(""),K=a.useRef(null),[X,I]=a.useState(!1),ye=Array.from(new Map(Ae.flatMap(l=>l.subcategories.map(f=>({subcategory:f.trim(),icon:l.icon}))).map(l=>[l.subcategory.toLowerCase(),l])).values()).sort((l,f)=>l.subcategory.localeCompare(f.subcategory)),Q=l=>l.trim().toLowerCase().replace(/–/g,"-"),be=ye.filter(l=>O?Q(l.subcategory).startsWith(Q(O)):!0);if(a.useEffect(()=>{if(s&&(m(t?.name||""),u(t?.avatar||""),$(null),R(t?.company_name||""),W(t?.address1||""),D(t?.address2||""),V(t?.city||""),Z(t?.us_state||""),G(t?.post_code||""),H(t?.website||""),Y(t?.industry||""),q(t?.employees||""),J(t?.biz_type||""),t?.phone)){const l=se(t.phone);l&&(T(l.country||"US"),B(l.nationalNumber.toString()))}},[s,t]),!s)return null;const ge=()=>K.current?.click(),je=l=>{const f=l.target.files?.[0];f&&($(f),u(URL.createObjectURL(f)))},we=async()=>{if(!i.trim()){x.error("Name is required!");return}if(!/^[A-Za-z ]+$/.test(i.trim())){x.error("Full Name should only contain letters and spaces.");return}if(g.trim()&&!/^[A-Za-z ]+$/.test(g.trim())){x.error("Company Name should only contain letters and spaces (no numbers allowed).");return}const Ne=`${S.find(p=>p.code===b)?.dialCode||""}${U}`,v=se(Ne);let C=null;try{const p=Me(b,Ue);p&&(C=p.nationalNumber.toString().length)}catch{C=null}if(!v||!v.isValid()){let h=`Phone number for ${S.find(o=>o.code===b)?.name||b} must be valid.`;C&&(h+=` Expected ${C} digits.`),x.error(h);return}if(w&&!/^[0-9]+$/.test(w.trim())){x.error("Post Code must be numeric.");return}if(j&&!/^[A-Za-z ]+$/.test(j.trim())){x.error("City name must contain only letters and spaces.");return}if(N.trim()&&!/^www\.[^\s]+\.(com|org|net|edu|gov|mil|info|biz|xyz|online|io|ai|tech|app|dev)(\.[a-z]{2,3})?$/i.test(N.trim())){x.error("Invalid website. Example: www.example.com");return}I(!0);try{const p=localStorage.getItem("accessToken"),h=new FormData;i.trim()!==t?.name&&h.append("full_name",i.trim()),v.number!==t?.phone&&h.append("phone",v.number),d&&h.append("image",d);const o={};if(g.trim()!==t?.company_name&&(o.company_name=g.trim()),k.trim()!==t?.address1&&(o.address1=k.trim()),P.trim()!==t?.address2&&(o.address2=P.trim()),j.trim()!==t?.city&&(o.city=j.trim()),F.trim()!==t?.us_state&&(o.us_state=F.trim()),w.trim()!==t?.post_code&&(o.post_code=w.trim()),N.trim()!==t?.website&&(o.website=N.trim()),E.trim()!==t?.industry&&(o.industry=E.trim()),z.trim()!==t?.employees&&(o.employees=z.trim()),_.trim()!==t?.biz_type&&(o.biz_type=_.trim()),Object.keys(o).length>0&&h.append("business_info",JSON.stringify(o)),[...h.keys()].length===0){x.info("No changes made."),I(!1);return}const A=await fetch(`${Be}/auth/update_user/`,{method:"POST",headers:{Authorization:p?`Bearer ${p}`:""},body:h}),ve=await A.json();if(!A.ok){x.error(ve?.error||`Failed (${A.status})`);return}x.success("Profile updated successfully!"),await c(),n()}catch(p){console.error("[update-user] error:",p),x.error("Network error while updating profile.")}finally{I(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/30 p-4",children:[e.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-3xl shadow-xl relative",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 pt-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-primary-blue",children:"Edit Profile"}),e.jsx("button",{onClick:n,className:"h-8 w-8 rounded-full border grid place-items-center",children:e.jsx(Ce,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 mt-3 flex flex-col items-center",children:[e.jsx("img",{src:r,alt:"avatar",className:"h-24 w-24 rounded-full object-cover ring-2 ring-white shadow"}),e.jsxs("button",{type:"button",onClick:ge,className:"mt-2 px-3 py-2 rounded-full bg-secondary-blue text-white flex items-center gap-1 text-xs",children:[e.jsx(Se,{})," Change Photo"]}),e.jsx("input",{ref:K,type:"file",accept:"image/*",className:"hidden",onChange:je})]}),e.jsxs("div",{className:"px-6 pb-6 pt-4 space-y-5 overflow-y-auto max-h-[70vh]",children:[e.jsx(y,{icon:e.jsx(ke,{}),label:"Full Name",required:!0,value:i,onChange:m}),e.jsx(Ge,{country:b,setCountry:T,localPhone:U,setLocalPhone:B,openCountry:ne,setOpenCountry:ie}),e.jsx(y,{icon:e.jsx(re,{}),label:"Email",value:t?.email||"",disabled:!0}),e.jsx("hr",{className:"my-4"}),e.jsx(y,{icon:e.jsx(Pe,{}),label:"Company Name",value:g,onChange:R}),e.jsx(y,{icon:e.jsx(ee,{}),label:"Address 1",value:k,onChange:W}),e.jsx(y,{icon:e.jsx(ee,{}),label:"Address 2",value:P,onChange:D}),e.jsx(y,{icon:e.jsx(L,{}),label:"City",value:j,onChange:V}),e.jsx(Ze,{label:"Industry",value:E,setValue:Y,open:oe,setOpen:ce,search:O,setSearch:fe,filtered:be}),e.jsx(M,{label:"Employees",icon:e.jsx(Fe,{}),open:de,setOpen:me,options:Re,value:z,setValue:q}),e.jsx(M,{label:"Business Type",icon:e.jsx(Ee,{}),open:ue,setOpen:pe,options:We,value:_,setValue:J}),e.jsx(M,{label:"State",icon:e.jsx(L,{}),open:xe,setOpen:he,options:De,value:F,setValue:Z}),e.jsx(y,{icon:e.jsx(L,{}),label:"Post Code",value:w,onChange:G}),e.jsx(y,{icon:e.jsx(ze,{}),label:"Website",value:N,onChange:H}),e.jsx(le,{text:X?"Updating...":"Update",fullWidth:!0,onClick:we,disabled:X})]})]}),e.jsx(_e,{position:"top-right",autoClose:3e3,hideProgressBar:!0})]})},y=({icon:s,label:n,value:t,onChange:c,required:i,disabled:m})=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium mb-2 text-primary-blue",children:[n," ",i&&e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-5 top-1/2 -translate-y-1/2 text-primary-purple",children:s}),e.jsx("input",{type:"text",value:t,onChange:r=>c?.(r.target.value),disabled:m,className:`w-full pl-12 pr-4 py-3 rounded-full border text-sm ${m?"bg-gray-50 text-gray-500":"bg-white"}`})]})]}),M=({label:s,icon:n,open:t,setOpen:c,options:i,value:m,setValue:r})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-2 text-primary-blue",children:s}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-5 top-1/2 -translate-y-1/2 text-primary-purple",children:n}),e.jsx("button",{type:"button",onClick:()=>c(u=>!u),className:"w-full pl-12 pr-10 py-3 rounded-full border bg-white text-sm text-gray-800 text-left",children:m||`Select ${s}`}),t&&e.jsx("ul",{className:"absolute z-40 mt-1 w-full bg-white border rounded-2xl shadow-lg max-h-44 overflow-auto text-sm",children:i.map(u=>e.jsx("li",{children:e.jsx("button",{type:"button",onClick:()=>{r(u),c(!1)},className:"w-full text-left px-4 py-2 hover:bg-primary-purple/10",children:u})},u))})]})]}),Ze=({label:s,value:n,setValue:t,open:c,setOpen:i,search:m,setSearch:r,filtered:u})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-2 text-primary-blue",children:s}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-5 top-1/2 -translate-y-1/2",children:e.jsx("img",{src:n?u.find(d=>d.subcategory===n)?.icon||te:te,alt:"",className:"h-5 w-5"})}),e.jsx("button",{type:"button",onClick:()=>i(d=>!d),className:"w-full pl-12 pr-10 py-3 rounded-full border bg-white text-sm text-gray-800 text-left",children:n||`Select ${s}`}),c&&e.jsxs("div",{className:"absolute z-40 mt-1 w-full bg-white border rounded-2xl shadow-lg max-h-56 overflow-auto text-sm",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b p-2",children:e.jsx("input",{type:"text",value:m,onChange:d=>r(d.target.value),placeholder:"Search...",className:"w-full px-3 py-2 rounded-full border text-sm"})}),e.jsx("ul",{children:u.length>0?u.map(d=>e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{t(d.subcategory),i(!1),r("")},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-primary-purple/10",children:[e.jsx("img",{src:d.icon,alt:"",className:"h-4 w-4"})," ",d.subcategory]})},d.subcategory)):e.jsx("li",{className:"px-4 py-2 text-gray-400",children:"No result"})})]})]})]}),Ge=({country:s,setCountry:n,localPhone:t,setLocalPhone:c,openCountry:i,setOpenCountry:m})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-2 text-primary-blue",children:"Phone"}),e.jsxs("div",{className:"relative flex",children:[e.jsxs("button",{type:"button",onClick:()=>m(r=>!r),className:"pl-3 pr-8 py-3 rounded-l-full bg-white border border-gray-200 text-sm text-gray-800 flex items-center",style:{minWidth:"100px"},children:[S.find(r=>r.code===s)?.dialCode||"+--",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`ml-6 h-3 w-3 text-gray-500 transition-transform ${i?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),e.jsx("input",{type:"tel",placeholder:"Enter Phone",value:t,onChange:r=>c(r.target.value.replace(/\D/g,"")),className:"flex-1 pl-4 pr-4 py-3 rounded-r-full bg-white border border-gray-200 text-sm text-gray-800 placeholder-gray-400 outline-none"}),i&&e.jsx("ul",{className:"absolute top-full left-0 mt-1 w-72 bg-white border border-gray-200 rounded-2xl shadow-lg max-h-52 overflow-auto text-sm z-50",children:S.map(r=>e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:()=>{n(r.code),m(!1)},className:"w-full flex justify-start gap-3 px-3 py-2 hover:bg-primary-purple/5",children:[e.jsx("span",{className:"font-semibold w-12",children:r.dialCode}),e.jsx("span",{children:r.name})]})},r.code))})]})]}),Xe=()=>{const{user:s,loading:n}=ae(),[t,c]=a.useState(!1);return n?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(Oe,{})}):s?e.jsxs("div",{className:"p-10",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-black/5 shadow-sm sm:p-10 p-8 max-w-4xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 md:gap-6 items-center",children:[e.jsx("div",{className:"flex items-center md:justify-start justify-center md:border-r col-span-1 md:pr-4 md:mb-0 mb-8",children:s.avatar&&e.jsx("img",{src:s.avatar,alt:s.name,className:"h-40 w-40 rounded-full object-cover ring-2 ring-white shadow"})}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-3xl font-semibold text-primary-blue",children:s.name}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center sm:gap-5 gap-3 sm:text-sm text-xs text-gray-500",children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(re,{className:"text-primary-purple"}),s.email]}),s.phone&&e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(Ie,{className:"text-primary-purple"}),s.phone]})]}),e.jsx("div",{className:"mt-10",children:e.jsx(le,{text:"Edit Profile",onClick:()=>c(!0),fullWidth:!1,mt:"mt-0",py:"py-2 sm:py-3"})})]})]})}),e.jsx(Ve,{open:t,onClose:()=>c(!1)})]}):e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Failed to load profile."})};export{Xe as default};
