import{u as k,r as o,R as S,j as e,L as f}from"./index-BgEUVMVN.js";import{S as C}from"./SideDesign-BfHhCSgL.js";import{B as E}from"./Button-CUqMWvy7.js";import{l as L,A as I,a as D}from"./index-BwWIKzrQ.js";import{m as F}from"./sms-DiCkCrsD.js";import{L as O,y as u}from"./ReactToastify-CieeUkh0.js";const P="/api",M=()=>{const y=k(),i=o.useContext(S);o.useEffect(()=>{i?.clearRegistrationData(),i?.setTempToken?.(""),i?.finishSignup({clear:!0})},[]);const[l,b]=o.useState({email:localStorage.getItem("rememberEmail")||"",password:""}),[x,w]=o.useState(!!localStorage.getItem("rememberEmail")),[n,j]=o.useState(!1),[c,g]=o.useState(!1),h=a=>{const{name:t,value:s}=a.target;b(m=>({...m,[t]:s}))},N=async a=>{if(a.preventDefault(),c)return;g(!0);const t=new FormData;t.append("email",l.email.trim()),t.append("password",l.password),t.append("type","web"),t.append("role","company");try{const s=await fetch(`${P}/auth/login/`,{method:"POST",body:t});if(s.status===429||s.status===502||s.status===503){u.error("Server is busy, please try again.");return}const m={};s.headers.forEach((d,v)=>m[v]=d);const p=await s.text();let r=null;try{r=p?JSON.parse(p):null}catch{}if(!s.ok){const d=r&&typeof r!="string"&&(r.error||r.detail||r.message)||(typeof r=="string"?r:p||"Invalid credentials");u.error(d);return}r?.tokens?.access&&localStorage.setItem("accessToken",r.tokens.access),x&&l.email.trim()?localStorage.setItem("rememberEmail",l.email.trim()):localStorage.removeItem("rememberEmail"),y("/Dashboard")}catch(s){console.error("[login] network error:",s),u.error("Network error. Try again.")}finally{g(!1)}};return e.jsxs("div",{className:"grid md:grid-cols-5 w-full min-h-screen",children:[e.jsx(C,{}),e.jsx("div",{className:"md:col-span-3 flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 mb-8",children:[e.jsx("h1",{className:"text-primary-blue font-semibold sm:text-4xt text-3xl",children:"Login"}),e.jsx("p",{className:"text-xs text-gray-700 text-center",children:"Enter your email and password to log in"})]}),e.jsxs("form",{className:"flex flex-col gap-5",autoComplete:"off",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-xs text-primary-blue font-medium mb-2",children:["Email Address",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2",children:e.jsx("img",{src:F,alt:"email",className:"h-5 w-5"})}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,placeholder:"Enter your email",value:l.email,onChange:h,autoComplete:"email",className:"w-full pl-14 pr-4 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-primary-blue/20 focus:border-primary-blue/50"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"block text-xs text-primary-blue font-medium mb-2",children:["Password",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2",children:e.jsx("img",{src:L,alt:"password",className:"h-5 w-5"})}),e.jsx("button",{type:"button","aria-label":n?"Hide password":"Show password",onClick:()=>j(a=>!a),className:"absolute right-4 top-1/2 -translate-y-1/2 text-primary-purple hover:text-primary-purple/90 transition",children:n?e.jsx(I,{className:"h-5 w-5"}):e.jsx(D,{className:"h-5 w-5"})}),e.jsx("input",{id:"password",name:"password",type:n?"text":"password",required:!0,placeholder:"Enter your password",value:l.password,onChange:h,autoComplete:"current-password",className:"w-full pl-14 pr-12 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-primary-blue/20 focus:border-primary-blue/50"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-primary-blue",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:a=>w(a.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary-purple focus:ring-primary-purple checked:bg-primary-purple checked:border-primary-purple"}),e.jsx("span",{children:"Remember me"})]}),e.jsx(f,{to:"/ForgetPassword",className:"text-xs font-semibold text-primary-purple/80 hover:text-primary-purple transition hover:scale-[101%]",children:"Forgot your password?"})]}),e.jsx(E,{text:c?"Logging in...":"Login",disabled:c,onClick:N})]}),e.jsxs("p",{className:"mt-6 text-center text-xs text-gray-600",children:["Donâ€™t have an account?"," ",e.jsx(f,{to:"/Signup",className:"text-primary-purple font-semibold underline-offset-2 inline-block hover:scale-[103%] duration-300",children:"Sign up"})]})]})}),e.jsx(O,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})]})};export{M as default};
