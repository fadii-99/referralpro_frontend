import{j as e,F as M,f as E,r,g as k,h as T,i as S,k as P,l as A,S as F}from"./index-BgEUVMVN.js";import{B as y}from"./Button-CUqMWvy7.js";import{P as U}from"./Pagination-rGSCO3Nd.js";import{y as j,L as $}from"./ReactToastify-CieeUkh0.js";const I=({role:t})=>e.jsx("span",{className:"inline-flex items-center px-3 py-2 rounded-lg md:text-sm text-xs font-medium text-primary-purple bg-primary-purple/10",children:t}),_=({status:t})=>{const l={Active:"text-emerald-700 bg-emerald-100",Inactive:"text-rose-700 bg-rose-100",Pending:"text-amber-700 bg-amber-100"}[t]||"text-gray-700 bg-gray-100";return e.jsx("span",{className:`inline-flex items-center px-3 py-2 rounded-lg md:text-sm text-xs font-medium ${l}`,children:t})},z=({member:t,displayId:s,onEdit:l,onDelete:n})=>e.jsxs("div",{className:"grid grid-cols-[0.6fr_2fr_1.8fr_1.2fr_1.2fr_1fr] min-w-[650px] items-center bg-white rounded-2xl md:px-6 px-3 py-3 border border-black/5 shadow-sm",children:[e.jsx("div",{className:"font-medium text-gray-700 md:text-sm text-xs",children:s??t.id}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-gray-700 md:text-sm text-xs",children:t.name})}),e.jsx("div",{className:"text-gray-600 md:text-sm text-xs pr-2",children:t.email}),e.jsx("div",{children:e.jsx(I,{role:t.role})}),e.jsx("div",{children:e.jsx(_,{status:t.status})}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pr-3",children:[e.jsx("button",{type:"button",className:"text-primary-purple hover:opacity-80","aria-label":"Edit",onClick:()=>l?.(t),children:e.jsx(M,{})}),e.jsx("button",{type:"button",className:"text-primary-purple hover:opacity-80","aria-label":"Delete",onClick:()=>n?.(t),children:e.jsx(E,{})})]})]}),B="/api",L=({open:t,member:s,onClose:l,onSave:n})=>{const[d,o]=r.useState(""),[m,c]=r.useState(!1);if(r.useEffect(()=>{t&&s&&(o(s.name??""),c(!1))},[t,s]),!t||!s)return null;const i=async()=>{const p=localStorage.getItem("accessToken")||"";if(p)try{c(!0);const a=new FormData;a.append("id",s.id),a.append("name",d.trim());const x=await fetch(`${B}/auth/employees/`,{method:"PUT",headers:{Authorization:`Bearer ${p}`},body:a});if(!x.ok){console.error("[EditMember] PUT failed:",x.status,await x.text()),c(!1);return}l(),await n()}catch(a){console.error("[EditMember] PUT error:",a)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/30 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-3xl shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-blue",children:"Edit Member"}),e.jsx("button",{onClick:l,"aria-label":"Close",className:"h-8 w-8 rounded-full border grid place-items-center hover:bg-gray-100",children:e.jsx(k,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(T,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",value:d,onChange:p=>o(p.target.value),placeholder:"Enter name",className:"w-full pl-14 pr-4 py-4 rounded-full border text-sm text-gray-800 outline-none focus:ring-2 focus:ring-primary-blue/20"})]})]}),e.jsx(y,{text:m?"Updating...":"Update",fullWidth:!0,py:"py-4",mt:"mt-0",onClick:i,disabled:m||!d.trim()})]})]})})},O="/api",R=({open:t,member:s,onClose:l})=>{const{loadTeam:n}=S(),[d,o]=r.useState(!1);if(!t||!s)return null;const m=async()=>{const c=localStorage.getItem("accessToken")||"";if(c)try{o(!0);const i=await fetch(`${O}/auth/employees/?id=${encodeURIComponent(s.id)}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});if(!i.ok){console.error("[DeleteMember] failed:",i.status,await i.text());return}await n(),l()}catch(i){console.error("[DeleteMember] error:",i)}finally{o(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/30 backdrop-blur-[1px] p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-3xl shadow-xl relative",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 pt-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary-blue",children:"Delete Member"}),e.jsx("button",{onClick:l,"aria-label":"Close",className:"h-8 w-8 rounded-full bg-white border grid place-items-center",children:e.jsx(k,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx("span",{className:"h-10 w-10 rounded-xl bg-rose-50 text-rose-600 grid place-items-center",children:e.jsx(E,{})}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Do you want to delete"," ",e.jsx("span",{className:"font-semibold text-[#0b0d3b]",children:s.name}),"? This action cannot be undone."]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(y,{text:d?"Deleting...":"Delete",fullWidth:!0,mt:"mt-0",py:"py-2 sm:py-3",className:"bg-rose-500 text-white hover:opacity-95",onClick:m,disabled:d})})]})]})})},W="/api",J=({open:t,onClose:s})=>{const{loadTeam:l}=S(),[n,d]=r.useState(""),[o,m]=r.useState(""),[c,i]=r.useState(!1);if(!t)return null;const p=async()=>{if(!n.trim()||!o.trim()){j.error("Name and Email are required!");return}i(!0);try{const a=localStorage.getItem("accessToken"),x=new FormData;x.append("name",n.trim()),x.append("email",o.trim());const u=await fetch(`${W}/auth/employees/`,{method:"POST",headers:{Authorization:a?`Bearer ${a}`:""},body:x}),h=await u.text();let f=null;try{f=h?JSON.parse(h):null}catch{}if(!u.ok){j.error(f?.error||`Failed (${u.status})`);return}j.success("Invite sent successfully!"),d(""),m(""),s(),await l()}catch(a){console.error("[send-invite] error:",a),j.error("Network error while sending invite.")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/30 backdrop-blur-[1px] p-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-3xl shadow-xl relative",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-6",children:[e.jsx("h3",{className:"text-2xl font-semibold text-primary-blue",children:"Add Member"}),e.jsx("button",{onClick:s,"aria-label":"Close",className:"h-8 w-8 rounded-full bg-white border border-black/5 shadow-sm grid place-items-center hover:shadow transition",children:e.jsx(k,{className:"text-primary-purple"})})]}),e.jsxs("div",{className:"px-6 pb-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(T,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",placeholder:"John Smith",value:n,onChange:a=>d(a.target.value),className:"w-full pl-14 pr-4 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-primary-blue font-medium mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary-purple",children:e.jsx(P,{className:"h-5 w-5"})}),e.jsx("input",{type:"email",placeholder:"email@example.com",value:o,onChange:a=>m(a.target.value),className:"w-full pl-14 pr-4 py-5 rounded-full bg-white border border-gray-200 text-xs text-gray-800 placeholder-gray-400 outline-none"})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(y,{text:c?"Sending...":"Send Invite",fullWidth:!0,py:"py-5",mt:"mt-0",onClick:p,disabled:c})})]})]})})},K=()=>{const{membersFromApi:t,loading:s,loadTeam:l}=S(),[n,d]=r.useState(1),[o,m]=r.useState(!1),[c,i]=r.useState(!1),[p,a]=r.useState(null),[x,u]=r.useState(!1),[h,f]=r.useState(null);r.useEffect(()=>{l()},[l]);const g=8,v=(n-1)*g,N=t.slice(v,v+g),C=Math.max(1,Math.ceil(t.length/g));return e.jsxs("div",{className:"sm:p-6 p-4 flex flex-col min-h-screen",children:[e.jsxs("div",{className:"flex sm:flex-row flex-col sm:items-center items-start sm:justify-between  sm:pb-4 pb-6",children:[e.jsx("h2",{className:"md:text-2xl text-xl font-semibold text-primary-blue",children:"Team Management"}),e.jsxs("div",{className:"flex flex-row items-center gap-3 sm:mt-0 mt-4",children:[e.jsx(y,{text:"Add Member",py:"py-2 sm:py-3",mt:"mt-0",fullWidth:!1,onClick:()=>m(!0)}),e.jsx("button",{className:"h-10 w-10 rounded-xl bg-white border border-black/5 shadow-sm flex items-center justify-center",children:e.jsx(A,{className:"text-primary-purple text-lg"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"grid grid-cols-[0.6fr_2fr_1.8fr_1.2fr_1.2fr_1fr] min-w-[650px] px-6 py-3 text-xs sm:text-sm font-semibold text-gray-600 bg-gray-50 rounded-xl",children:[e.jsx("div",{children:"ID"}),e.jsx("div",{children:"Name"}),e.jsx("div",{children:"Email"}),e.jsx("div",{children:"Role"}),e.jsx("div",{children:"Status"}),e.jsx("div",{className:"text-right pr-3",children:"Actions"})]})}),e.jsx("div",{className:"overflow-x-auto space-y-2",children:s?e.jsx("div",{className:"py-6 flex justify-center",children:e.jsx(F,{})}):N.length===0?e.jsx("div",{className:"text-sm p-8 text-center text-gray-500",children:"No team members found."}):N.map((b,D)=>e.jsx(z,{member:b,displayId:v+D+1,onEdit:w=>{a(w),i(!0)},onDelete:w=>{f(w),u(!0)}},b.id))})]}),N.length>0&&!s&&e.jsx("div",{className:"mt-auto pt-6 flex justify-end",children:e.jsx(U,{current:n,totalPages:C,onChange:b=>d(b)})}),e.jsx(L,{open:c,member:p,onClose:()=>i(!1),onSave:async()=>{await l()}}),e.jsx(R,{open:x,member:h,onClose:()=>u(!1)}),e.jsx(J,{open:o,onClose:()=>m(!1)}),e.jsx($,{position:"top-right",autoClose:3e3,hideProgressBar:!0})]})};export{K as default};
